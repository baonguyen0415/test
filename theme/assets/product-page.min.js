(()=>{var v={onLoad(){let{container:e}=this;try{AT.detectVisible({element:e,rootMargin:"0px",callback:()=>{e.querySelector("slider-component").init()}})}catch(t){console.log(e),console.error(t)}}};var b=(e,t,r)=>{let n={};if(!e)return;console.log(t);let h=e.dataset.statusSoldOut,c=e.getElementsByClassName("js-option-item");if(t.variants.length<2)return;c.addEvents("change",function(){e.dispatchEvent(new CustomEvent("swatch-change",{detail:{position:+this.dataset.optionPosition,optionValue:this.value}}))}),e.addEvent("swatch-change",function({detail:{position:s,optionValue:o}}){switch(e.querySelector(`[data-selected-option='option${s}']`).innerHTML=o,s){case 1:t.options.length>1?m(2):r(f(p()));break;case 2:t.options.length===3?m(3):r(f(p()));break;case 3:r(f(p()));break}}),t.variants.forEach(s=>{if(s.available){if(n.root=n.root||[],n.root.push(s.option1),n.root=n.root.reduce((i,a)=>(i.includes(a)||i.push(a),i),[]),t.options.length>1){var o=s.option1;n[o]=n[o]||[],n[o].push(s.option2),n[o]=n[o].reduce((i,a)=>(i.includes(a)||i.push(a),i),[])}if(t.options.length===3){var o=s.option1+" / "+s.option2;n[o]=n[o]||[],n[o].push(s.option3),n[o]=n[o].reduce((a,d)=>(a.includes(d)||a.push(d),a),[])}}}),m(1);function m(s){let o=p(),i,a;switch(s){case 1:i="root",a=e.querySelector(".js-swatch-item[data-position='1']");break;case 2:i=o.option1,a=e.querySelector(".js-swatch-item[data-position='2']");break;case 3:i=o.option1+" / "+o.option2,a=e.querySelector(".js-swatch-item[data-position='3']");break}switch(a.dataset.style){case"select":{let l=a.getElementsByClassName("js-option-item")[0],w=l.value;switch(h){case"hide":{l.innerHTML=n[i].map(u=>`<option value="${u}">${u}</option>`).join(""),n[i].includes(w)&&(l.value=w);break}case"disable":{[...l.options].forEach(u=>{n[i].includes(u.value)?u.disabled=!1:(u.disabled=!0,u.selected=!1)}),[...l.options].find(u=>u.disabled==!1&&(u.selected=!0));break}}break}case"color":case"image":case"button":let d=a.getElementsByClassName("js-option-item"),y=[...d].find(l=>l.checked).value;switch(h){case"hide":d.forEach(l=>{n[i].includes(l.value)?l.closest(".swatch-group_wrapper").removeClass("d-none"):(l.closest(".swatch-group_wrapper").addClass("d-none"),y===l.value&&(l.checked=!1,d[0].checked=!0))});break;case"disable":{d.forEach(l=>{n[i].includes(l.value)?l.disabled=!1:(l.disabled=!0,y===l.value&&(l.checked=!1,d[0].checked=!0))});break}}break}e.dispatchEvent(new CustomEvent("swatch-change",{detail:{position:s,optionValue:o[`option${s}`]}}))}function p(){return[...e.getElementsByClassName("js-swatch-item")].reduce((s,o)=>{switch(o.dataset.style){case"select":let i=o.querySelector("select.single-option-selector");s[i.name]=i.value;break;case"color":case"image":case"button":let a=o.querySelectorAll("input[data-single-option-selector]");s[a[0].name]=[...a].find(d=>d.checked).value;break}return s},{})}function f(s){return t.variants.find(o=>Object.keys(s).every(i=>o[i]===s[i]))}};var g={onLoad:function(){let e=this.container;if(this.product=theme.product,this.elms={priceCompareElement:e.querySelector(".js-price-compare"),priceElement:e.querySelector(".js-price"),skuElement:e.querySelector(".js-sku"),inventoryElement:e.querySelector(".js-inventory"),mediaMain:document.getElementById("product-media-main"),mediaThumnails:document.getElementById("product-media-thumnails"),selectMaster:e.querySelector("#select-master"),addToCartButton:e.querySelector(".js-atc-btn"),formElement:e.querySelector("form[action*='/cart/add']"),reviewsWidget:e.querySelector("#product-reviews-widget"),reviewsBadge:e.querySelector("#product-review-badge"),labelSaveContainer:e.querySelector(".js-product-label-save"),swatchContainer:e.querySelector("swatch-component"),findStoreButton:e.querySelector(".js-find-store-btn"),quantityInputContainer:e.querySelector(".js-product-quantity"),subscribeForm:e.querySelector("#contact-notify-when-available"),dynamicCheckoutContainer:e.querySelector(".js-product-dymanic-checkout")},this.settings=JSON.parse(this.container.querySelector("[data-settings]").innerHTML),this.initSliderMedia(),this.initInventory(),this.initFormAddToCart(),b(this.elms.swatchContainer,this.product,this.handleVariantChange.bind(this)),this.initScrollToReviews(),AT.getParameterByName("contact_posted")){this.switchVariantById(AT.cookie.get("subscribe-variant-id")),AT.cookie.delete("subscribe-variant-id");let t=window.location.search.replace("?","").split("&").filter(r=>!r.includes("contact_posted")).filter(Boolean).join("&");window.history.replaceState({},"",`${window.location.pathname}?${t}`)}},initSliderMedia:function(){let{mediaMain:e,mediaThumnails:t}=this.elms;this.mainSlider=e.init({gutter:12}),t.init()},handleVariantChange:function(e){let{skuElement:t,selectMaster:r,mediaMain:n}=this.elms;if(!e){this.updateVariantStatus(),n.addClass("product-sold-out");return}this.currentVariant=e,this.updateLabelSave(e),this.updateVariantStatus(e),this.updatePrice(e),this.updateURLHash(e),e.available?n.removeClass("product-sold-out"):n.addClass("product-sold-out"),e.sku?t.innerHTML=e.sku:t.innerHTML=theme.strings.product.skuNA,e.featured_media&&this.mainSlider.goTo(e.featured_media.position-1),r.value=e.id},initInventory(){let{inventoryElement:e}=this.elms;this.inventory={setStatus:(t,r)=>{if(!!this.settings.showInventory)switch(e.setAttribute("data-status",t),t){case"coming-stock":{e.querySelector(".inventory_coming-stock").innerHTML=theme.strings.dateComingStock.replace("{{date}}",r.next_incoming_date);break}case"low-stock":{e.querySelector(".inventory_low-stock").innerHTML=(r.inventory_quantity>1?theme.strings.product.itemsLowStock:theme.strings.product.itemLowStock).replace("{{quantity}}",r.inventory_quantity);break}case"items-stock":{e.querySelector(".inventory_items-stock").innerHTML=(r.inventory_quantity>1?theme.strings.product.itemsStock:theme.strings.product.itemStock).replace("{{quantity}}",r.inventory_quantity);break}}}}},updateVariantStatus(e){let{addToCartButton:t}=this.elms;e?(this.settings.enableSubscribe&&(this.updateDynamicCheckout(e.available),this.updateSubscribeForm(e)),this.updateAddToCartButton(e),this.updateInventory(e)):(t.disabled=!0,t.querySelector("span").innerHTML=theme.strings.product.soldOut,this.inventory.setStatus("out-stock"))},updateDynamicCheckout(e){let{dynamicCheckoutContainer:t}=this.elms;t&&(e?t.removeClass("d-none"):t.addClass("d-none"))},updateSubscribeForm(e){let{subscribeForm:t}=this.elms,r=t.querySelector("input[name='contact[body]']"),n=t.querySelector(".js-product-subscribe");!AT.getParameterByName("contact_posted")&&n.removeClass("posted-successfully"),r.value=r.dataset.value.replace("{{product_name}}",e.name),e.available?n.addClass("d-none"):n.removeClass("d-none"),t.addEvent("submit",()=>{AT.cookie.set("subscribe-variant-id",this.currentVariant.id)})},updateAddToCartButton(e){let{addToCartButton:t,quantityInputContainer:r}=this.elms;e.available?(t.disabled=!1,t.querySelector("span").innerHTML=e.inventory_quantity==0&&e.incoming?theme.strings.product.preorder:theme.strings.product.addToCart,this.settings.enableSubscribe&&r.removeClass("d-none")):(t.disabled=!0,t.querySelector("span").innerHTML=theme.strings.product.soldOut,this.settings.enableSubscribe&&r.addClass("d-none"))},updateInventory(e){e.available?e.inventory_management?e.inventory_quantity==0&&e.incoming?this.inventory.setStatus("coming-stock",e):e.inventory_quantity<=this.settings.inventoryThreshold?this.inventory.setStatus("low-stock",e):this.inventory.setStatus("items-stock",e):this.inventory.setStatus("in-stock"):this.inventory.setStatus("out-stock")},initFormAddToCart(){let{formElement:e,addToCartButton:t}=this.elms;e.addEvent("submit",r=>{r.preventDefault(),t.addClass("pending"),Cart.add(e).catch(n=>{AT.loadPopupMessage().then(()=>{Popups.closeAll(),PopupMessage.open(n.description)})}).finally(()=>{t.removeClass("pending")})})},initScrollToReviews(){let{reviewsWidget:e,reviewsBadge:t}=this.elms;t.addEvent("click",()=>AT.scrollTo(e,1e3,parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--header-height"))))},updateLabelSave(e){let{labelSaveContainer:t}=this.elms,r=t.querySelector(".js-percent"),n=t.querySelector(".js-money-saved"),{compare_at_price:h,price:c}=e;h>c?(n.innerHTML=(h-c).toCurrency(),r.innerHTML=Math.round((h-c)/h*100),t.removeClass("d-none")):t.addClass("d-none")},updatePrice(e){let{priceCompareElement:t,priceElement:r}=this.elms;e.compare_at_price?(t.innerHTML=e.compare_at_price.toCurrency(),t.removeClass("d-none")):t.addClass("d-none"),r.innerHTML=e.price.toCurrency()},updateURLHash(e){let t=window.location.search.replace("?","").split("&").filter(Boolean);window.history.replaceState({},"",AT.getParameterByName("variant")?`${window.location.pathname}?${t.map(r=>r.includes("variant")?"variant="+e.id:r).join("&")}`:(t.unshift("variant="+e.id),`${window.location.pathname}?${t.join("&")}`))},switchVariantById(e){let{swatchContainer:t}=this.elms,r=theme.product.variants.find(n=>n.id==e);!r||r.options.forEach((n,h)=>{[...t.querySelectorAll(`[name='option${h+1}']`)].find(c=>{switch(c.tagName){case"INPUT":c.value==n&&(c.checked=!0,c.dispatchEvent(new Event("change")));break;case"SELECT":c.value=n,c.dispatchEvent(new Event("change"));break}})})}};(()=>{theme.sectionRegister.forEach(e=>{switch(e){case"product-template":register(e,g);break;case"related-products":register(e,v);break}}),load("*"),console.log("product-page.js loaded")})();})();
