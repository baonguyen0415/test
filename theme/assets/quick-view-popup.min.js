(()=>{var S=(d,e,s)=>{let t={};if(!d)return;console.log(e);let r=d.dataset.statusSoldOut,h=d.getElementsByClassName("js-option-item");if(e.variants.length<2)return;h.addEvents("change",function(){d.dispatchEvent(new CustomEvent("swatch-change",{detail:{position:+this.dataset.optionPosition,optionValue:this.value}}))}),d.addEvent("swatch-change",function({detail:{position:n,optionValue:o}}){switch(d.querySelector(`[data-selected-option='option${n}']`).innerHTML=o,n){case 1:e.options.length>1?c(2):s(g(m()));break;case 2:e.options.length===3?c(3):s(g(m()));break;case 3:s(g(m()));break}}),e.variants.forEach(n=>{if(n.available){if(t.root=t.root||[],t.root.push(n.option1),t.root=t.root.reduce((i,a)=>(i.includes(a)||i.push(a),i),[]),e.options.length>1){var o=n.option1;t[o]=t[o]||[],t[o].push(n.option2),t[o]=t[o].reduce((i,a)=>(i.includes(a)||i.push(a),i),[])}if(e.options.length===3){var o=n.option1+" / "+n.option2;t[o]=t[o]||[],t[o].push(n.option3),t[o]=t[o].reduce((a,u)=>(a.includes(u)||a.push(u),a),[])}}}),c(1);function c(n){let o=m(),i,a;switch(n){case 1:i="root",a=d.querySelector(".js-swatch-item[data-position='1']");break;case 2:i=o.option1,a=d.querySelector(".js-swatch-item[data-position='2']");break;case 3:i=o.option1+" / "+o.option2,a=d.querySelector(".js-swatch-item[data-position='3']");break}switch(a.dataset.style){case"select":{let l=a.getElementsByClassName("js-option-item")[0],b=l.value;switch(r){case"hide":{l.innerHTML=t[i].map(p=>`<option value="${p}">${p}</option>`).join(""),t[i].includes(b)&&(l.value=b);break}case"disable":{[...l.options].forEach(p=>{t[i].includes(p.value)?p.disabled=!1:(p.disabled=!0,p.selected=!1)}),[...l.options].find(p=>p.disabled==!1&&(p.selected=!0));break}}break}case"color":case"image":case"button":let u=a.getElementsByClassName("js-option-item"),v=[...u].find(l=>l.checked).value;switch(r){case"hide":u.forEach(l=>{t[i].includes(l.value)?l.closest(".swatch-group_wrapper").removeClass("d-none"):(l.closest(".swatch-group_wrapper").addClass("d-none"),v===l.value&&(l.checked=!1,u[0].checked=!0))});break;case"disable":{u.forEach(l=>{t[i].includes(l.value)?l.disabled=!1:(l.disabled=!0,v===l.value&&(l.checked=!1,u[0].checked=!0))});break}}break}d.dispatchEvent(new CustomEvent("swatch-change",{detail:{position:n,optionValue:o[`option${n}`]}}))}function m(){return[...d.getElementsByClassName("js-swatch-item")].reduce((n,o)=>{switch(o.dataset.style){case"select":let i=o.querySelector("select.single-option-selector");n[i.name]=i.value;break;case"color":case"image":case"button":let a=o.querySelectorAll("input[data-single-option-selector]");n[a[0].name]=[...a].find(u=>u.checked).value;break}return n},{})}function g(n){return e.variants.find(o=>Object.keys(n).every(i=>o[i]===n[i]))}};var f=class extends HTMLElement{constructor(){super();this.getElementsByClassName("js-popup-close").addEvents("click",this.close.bind(this))}close(){this.removeClass("is-open"),AT.enableScroll()}open(){this.addClass("is-open"),AT.disableScroll()}};var w=class extends f{constructor(){super()}open(e){switch(this.querySelector(".js-popup-box-inner").innerHTML=e,this.elms={priceCompareElement:this.querySelector(".js-price-compare"),priceElement:this.querySelector(".js-price"),skuElement:this.querySelector(".js-sku"),inventoryElement:this.querySelector(".js-inventory"),mediaMain:this.querySelector("#quick-view-product-media-main"),mediaThumnails:this.querySelector("#quick-view-product-media-thumnails"),selectMaster:this.querySelector("#select-master"),addToCartButton:this.querySelector(".js-atc-btn"),formElement:this.querySelector("form[action*='/cart/add']"),labelSaveContainer:this.querySelector(".js-product-label-save"),swatchContainer:this.querySelector("swatch-component"),quantityInputContainer:this.querySelector(".js-product-quantity"),subscribeForm:this.querySelector("#contact-notify-when-available"),dynamicCheckoutContainer:this.querySelector(".js-product-dymanic-checkout")},this.settings=JSON.parse(this.querySelector("[data-settings]").innerHTML),this.product=JSON.parse(this.querySelector("[data-product-json]").innerHTML),this.variantsInventory=JSON.parse(this.querySelector("[data-variants-inventory-json]").innerHTML),Object.keys(this.variantsInventory).forEach(s=>{this.product.variants.find(t=>t.id==s&&Object.assign(t,this.variantsInventory[s]))}),this.initSliderMedia(),this.initInventory(),this.initFormAddToCart(),S(this.elms.swatchContainer,this.product,this.handleVariantChange.bind(this)),theme.settings.shop.reviewApp){case"shopify":window.SPR&&(window.SPR.initDomEls(),window.SPR.loadBadges());break}AT.debounce(()=>{this.addClass("is-open"),AT.disableScroll()},50)()}initSliderMedia(){let{mediaMain:e,mediaThumnails:s}=this.elms;!customElements.get("slider-component")&&AT.initCustomElements("slider-component"),this.mainSlider=e.init({gutter:12}),s.init()}handleVariantChange(e){let{skuElement:s,selectMaster:t,mediaMain:r}=this.elms;if(!e){this.updateVariantStatus(),r.addClass("product-sold-out");return}this.currentVariant=e,this.updateLabelSave(e),this.updateVariantStatus(e),this.updatePrice(e),e.available?r.removeClass("product-sold-out"):r.addClass("product-sold-out"),e.sku?s.innerHTML=e.sku:s.innerHTML=theme.strings.product.skuNA,e.featured_media&&this.mainSlider.goTo(e.featured_media.position-1),t.value=e.id}initInventory(){let{inventoryElement:e}=this.elms;this.inventory={setStatus:(s,t)=>{if(!!this.settings.showInventory)switch(e.setAttribute("data-status",s),s){case"coming-stock":{e.querySelector(".inventory_coming-stock").innerHTML=theme.strings.dateComingStock.replace("{{date}}",t.next_incoming_date);break}case"low-stock":{e.querySelector(".inventory_low-stock").innerHTML=(t.inventory_quantity>1?theme.strings.product.itemsLowStock:theme.strings.product.itemLowStock).replace("{{quantity}}",t.inventory_quantity);break}case"items-stock":{e.querySelector(".inventory_items-stock").innerHTML=(t.inventory_quantity>1?theme.strings.product.itemsStock:theme.strings.product.itemStock).replace("{{quantity}}",t.inventory_quantity);break}}}}}updateVariantStatus(e){let{addToCartButton:s}=this.elms;e?(this.settings.enableSubscribe&&(this.updateDynamicCheckout(e.available),this.updateSubscribeForm(e)),this.updateAddToCartButton(e),this.updateInventory(e)):(s.disabled=!0,s.querySelector("span").innerHTML=theme.strings.product.soldOut,this.inventory.setStatus("out-stock"))}updateDynamicCheckout(e){let{dynamicCheckoutContainer:s}=this.elms;s&&(e?s.removeClass("d-none"):s.addClass("d-none"))}updateSubscribeForm(e){let{subscribeForm:s}=this.elms,t=s.querySelector("input[name='contact[body]']"),r=s.querySelector(".js-product-subscribe");!AT.getParameterByName("contact_posted")&&r.removeClass("posted-successfully"),t.value=t.dataset.value.replace("{{product_name}}",e.name),e.available?r.addClass("d-none"):r.removeClass("d-none"),s.addEvent("submit",()=>{AT.cookie.set("subscribe-variant-id",this.currentVariant.id)})}updateAddToCartButton(e){let{addToCartButton:s,quantityInputContainer:t}=this.elms;e.available?(s.disabled=!1,s.querySelector("span").innerHTML=e.inventory_quantity==0&&e.incoming?theme.strings.product.preorder:theme.strings.product.addToCart,this.settings.enableSubscribe&&t.removeClass("d-none")):(s.disabled=!0,s.querySelector("span").innerHTML=theme.strings.product.soldOut,this.settings.enableSubscribe&&t.addClass("d-none"))}updateInventory(e){e.available?e.inventory_management?e.inventory_quantity==0&&e.incoming?this.inventory.setStatus("coming-stock",e):e.inventory_quantity<=this.settings.inventoryThreshold?this.inventory.setStatus("low-stock",e):this.inventory.setStatus("items-stock",e):this.inventory.setStatus("in-stock"):this.inventory.setStatus("out-stock")}initFormAddToCart(){let{formElement:e,addToCartButton:s}=this.elms;e.addEvent("submit",t=>{t.preventDefault(),s.addClass("pending"),Cart.add(e).then(()=>{this.close()}).catch(r=>{AT.loadPopupMessage().then(()=>{Popups.closeAll(),PopupMessage.open(r.description)})}).finally(()=>{s.removeClass("pending")})})}updateLabelSave(e){let{labelSaveContainer:s}=this.elms,t=s.querySelector(".js-percent"),r=s.querySelector(".js-money-saved"),{compare_at_price:h,price:c}=e;h>c?(r.innerHTML=(h-c).toCurrency(),t.innerHTML=Math.round((h-c)/h*100),s.removeClass("d-none")):s.addClass("d-none")}updatePrice(e){let{priceCompareElement:s,priceElement:t}=this.elms;e.compare_at_price?(s.innerHTML=e.compare_at_price.toCurrency(),s.removeClass("d-none")):s.addClass("d-none"),t.innerHTML=e.price.toCurrency()}switchVariantById(e){let{swatchContainer:s}=this.elms,t=theme.product.variants.find(r=>r.id==e);!t||t.options.forEach((r,h)=>{[...s.querySelectorAll(`[name='option${h+1}']`)].find(c=>{switch(c.tagName){case"INPUT":c.value==r&&(c.checked=!0,c.dispatchEvent(new Event("change")));break;case"SELECT":c.value=r,c.dispatchEvent(new Event("change"));break}})})}},E=document.getElementById("popup-container"),y=E.content.querySelector("popup-quick-view");y&&(E.insertAdjacentElement("beforebegin",y),customElements.define("popup-quick-view",w),window.PopupQuickView=y,Popups.push("popup-quick-view",window.PopupQuickView));console.log("popup-quick-view script loaded");})();
